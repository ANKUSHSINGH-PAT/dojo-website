<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Globalization Guidelines: Encoding &mdash; Dojo Reference Guide 1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <link rel="stylesheet" href="/css/guide.css?1">
    <script type="text/javascript">
      dojoConfig = {
        async: true
      };
    </script>
    <meta name="viewport" content="width=device-width, minimum-scale=0.75, maximum-scale=1">
    <meta name="format-detection" content="telephone=no">
    <script src="/scripts/dojo/dojo/dojo.js?1"></script>
    <script src="/scripts/dojo/docs/guide.js?1"></script>
    <link rel="stylesheet" href="/scripts/dojo/dijit/themes/claro/claro.css?1">
    <script src="/scripts/nav.js?1"></script>

  </head>
  <body role="document">
  

    <div class="document">

  <div class="nav">
	<div class="row">
		<div class="small-3 columns">
			<a href="/" class="navLogo icon-dojo icon"></a>
		</div>
		<div class="small-9 columns text-right">
			<div class="mobileMenuToggle" data-menu-toggle></div>
			<div class="menu">
				<div class="mobileHeader">Menu</div>
				<ul class="inline-list menuItems right">
					<li><a href="/download/" class="downloadLink">Get Dojo</a></li>
					<li><a href="/documentation" class="docsLink">Docs</a></li>
					<li><a href="/community" class="communityLink">Community</a></li>
					<li><a href="/community/roadmap/" class="roadmapLink">Roadmap</a></li>
					<li><a href="/blog/" class="blogLink">Blog</a></li>
				</ul>
			</div>
		</div>
	</div>
</div>
  <div class="subnav">
      <div class="row">
        <div class="medium-12 columns">
         <ul>
            <li><a href="../../../index.html">Startpage</a></li>
            <li><a href="../../../dojo/index.html">Dojo</a></li>
            <li><a href="../../../dijit/index.html">Dijit</a></li>
            <li><a href="../../../dojox/index.html">DojoX</a></li>
          </ul>
        </div>
        <!-- <div class="medium-3 columns text-right">
           <div id="dtkVersion">
            <select id="refver" name="refver">
              <option value="1.6">Dojo 1.6</option>
              <option value="1.7">Dojo 1.7</option>
              <option value="1.8">Dojo 1.8</option>
              <option value="1.9">Dojo 1.9</option>
              <option value="1.10" selected="selected">Dojo 1.10</option>
            </select>
          </div>
        </div>-->
      </div>
    </div>
  <main class="refguide">
    <div class="row">
      <div class="medium-9 columns content">
          
  <div class="section" id="globalization-guidelines-encoding">
<span id="quickstart-internationalization-globalization-guidelines-encoding-guidelines"></span><h1><a class="toc-backref" href="#id1">Globalization Guidelines: Encoding</a><a class="headerlink" href="#globalization-guidelines-encoding" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Authors:</th><td class="field-body">?&#8211;</td>
</tr>
<tr class="field-even field"><th class="field-name">since:</th><td class="field-body">V?</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#globalization-guidelines-encoding" id="id1">Globalization Guidelines: Encoding</a><ul>
<li><a class="reference internal" href="#the-utf-8-encoding" id="id2">The UTF-8 Encoding</a></li>
<li><a class="reference internal" href="#utf-8-file-encoding" id="id3">UTF-8 File Encoding</a></li>
<li><a class="reference internal" href="#sending-and-receiving-requests" id="id4">Sending and Receiving Requests</a></li>
<li><a class="reference internal" href="#sending-responses" id="id5">Sending Responses</a></li>
</ul>
</li>
</ul>
</div>
<p>The following guidelines should be used to implement internationalization in encoding.</p>
<div class="section" id="the-utf-8-encoding">
<h2><a class="toc-backref" href="#id2">The UTF-8 Encoding</a><a class="headerlink" href="#the-utf-8-encoding" title="Permalink to this headline">¶</a></h2>
<div class="section" id="you-should-always-use-utf-8-for-encoding-settings-wherever-applicable">
<h3>You should always use UTF-8 for encoding settings wherever applicable.<a class="headerlink" href="#you-should-always-use-utf-8-for-encoding-settings-wherever-applicable" title="Permalink to this headline">¶</a></h3>
<p>This is a general rule for Web application design and development. You should manually set the encoding for files or I/O streams wherever applicable, because the default encoding (usually ISO-8859-1) cannot handle all Unicode characters. UTF-8 is the best choice when you use Dojo in your application, since Dojo only uses UTF-8.</p>
<p>The rest of this guideline describes the details of setting encodings in a Web application.</p>
</div>
</div>
<div class="section" id="utf-8-file-encoding">
<h2><a class="toc-backref" href="#id3">UTF-8 File Encoding</a><a class="headerlink" href="#utf-8-file-encoding" title="Permalink to this headline">¶</a></h2>
<div class="section" id="you-should-encode-all-text-files-in-utf-8">
<h3>You should encode all text files in UTF-8.<a class="headerlink" href="#you-should-encode-all-text-files-in-utf-8" title="Permalink to this headline">¶</a></h3>
<p>You should encode all text files in UTF-8, including HTML files, CSS files, JavaScript files, etc.</p>
</div>
<div class="section" id="you-must-specify-the-utf-8-encoding-in-every-html-file-before-any-non-english-characters">
<h3>You must specify the UTF-8 encoding in every HTML file before any non-English characters.<a class="headerlink" href="#you-must-specify-the-utf-8-encoding-in-every-html-file-before-any-non-english-characters" title="Permalink to this headline">¶</a></h3>
<p>You must specify the encodings of all HTML files as early as possible. Ideally, this occurs on the server such that the server applies HTTP encoding headers to mark the document, otherwise this must be achieved in the browser using the meta tag. For example:</p>
<p>This encoding declaration must appear before any non-English characters in a file; otherwise a browser might fail to read it correctly. For example, IE 6.0/7.0 cannot render the following content (encoded in UTF-8):</p>
<p>By default, browsers assume that all files referred by an HTML file use the same encoding as the referring HTML file. So if you have the encoding of every HTML file specified, you do not need to declare the encoding setting in each CSS or JavaScript file again, but you can override the encoding anyway when some files are not in the same encoding as the HTML file. For example,</p>
</div>
</div>
<div class="section" id="sending-and-receiving-requests">
<h2><a class="toc-backref" href="#id4">Sending and Receiving Requests</a><a class="headerlink" href="#sending-and-receiving-requests" title="Permalink to this headline">¶</a></h2>
<div class="section" id="you-must-use-the-bom-header-for-utf-16-files">
<h3>You must use the BOM header for UTF-16 files.<a class="headerlink" href="#you-must-use-the-bom-header-for-utf-16-files" title="Permalink to this headline">¶</a></h3>
<p>A BOM header consists of 2, 3, or 4 bytes at the very beginning of a text file to indicate its encoding. For example, 0xFF 0xFE means that the file is encoded in UTF-16LE, while 0xEF 0xBB 0xBF means that the encoding is UTF-8. The BOM header can override the encoding settings mentioned above in a browser.</p>
<p>Using UTF-16 is not recommended, but if you choose it for some reason, the BOM header is required. Because UTF-16 is not compatible with ASCII, a browser even does not have a chance to read the encoding setting of the file content.</p>
</div>
<div class="section" id="you-must-use-utf-8-to-decode-xhr-request-parameters">
<h3>You must use UTF-8 to decode XHR request parameters.<a class="headerlink" href="#you-must-use-utf-8-to-decode-xhr-request-parameters" title="Permalink to this headline">¶</a></h3>
<p>The dojo.xhr* functions are the most common way in Dojo to enable Ajax features &#8211; sending an asynchronous request to the server by an XMLHttpRequest object. The typical call to one of these functions can be:</p>
<p>The url is where this request will be sent to. The content is the JSON object that will be sent in the request. In Dojo’s implementation, the key and value pairs in the content are encoded by the encodeURIComponent function first, and then converted to a query string like &#8220;key=value&amp;key=value&amp;...&#8221;. The xhrPost function puts the query string into the request content, and other functions like xhrGet append the query string to the end of the url, so the previous code is equal to the following code:</p>
<p>Because the encodeURIComponent function always uses UTF-8, you must use UTF-8 at the server side to decode the request parameters both in the URL (xhrGet) and in the request content (xhrPost).</p>
<p>For example, in Tomcat, you can set the encoding of URL by the URIEncoding attribute in server.xml:</p>
<p>You can set the encoding of the request content (xhrPost) by simply calling request.setCharacterEncoding before using the request object:</p>
<p>You MUST manually set the encoding on your server, because almost no Web server uses UTF-8 to decode URLs and request content by default. For example, Tomcat always uses ISO-8859-1 to deal with requests if you do not set the encoding. WebSphere uses a locale-encoding map to determine the request encoding from the client&#8217;s language, but no locale is mapped to UTF-8 by default.</p>
</div>
<div class="section" id="you-must-use-utf-8-encoding-when-using-a-non-english-string-in-a-url">
<h3>You must use UTF-8 encoding when using a non-English string in a URL.<a class="headerlink" href="#you-must-use-utf-8-encoding-when-using-a-non-english-string-in-a-url" title="Permalink to this headline">¶</a></h3>
<p>Some browsers like IE always send URLs using the default system encoding. For example, in a Simplified Chinese Windows XP operating system, IE sends a URL encoded in GB2312. If you need to put some non-English parameters in a URL, make sure that you have encoded it first using the encodeURIComponent function. For example, in a Simplified Chinese Windows XP, if you run the following script in IE:</p>
<p>You might get different results for name1 and name2 at the server side:</p>
<ul class="simple">
<li>name1 &#8211;&gt; 0xD2 0xBB (in GB2312, Wrong!)</li>
<li>name2 &#8211;&gt; 0xE4 0xB8 0x80 (in UTF-8, Right!)</li>
</ul>
<p>The right way is to encode name1 first:</p>
</div>
</div>
<div class="section" id="sending-responses">
<h2><a class="toc-backref" href="#id5">Sending Responses</a><a class="headerlink" href="#sending-responses" title="Permalink to this headline">¶</a></h2>
<div class="section" id="you-must-set-content-type-in-an-http-response-header-if-the-response-is-not-encoded-in-utf-8">
<h3>You must set Content-Type in an HTTP response header if the response is not encoded in UTF-8.<a class="headerlink" href="#you-must-set-content-type-in-an-http-response-header-if-the-response-is-not-encoded-in-utf-8" title="Permalink to this headline">¶</a></h3>
<p>An XMLHttpRequest object first checks the HTTP header of a response to see if there is a Content-Type property that sets the encoding of the response; otherwise, it always uses UTF-8 to decode the response into a string. Web servers usually set the Content-Type property automatically for dynamic files like JSP. However, for static files, Web servers probably do not know the encoding of the files and also do not set the Content-Type property for them.</p>
</div>
</div>
</div>


      </div>
      <div class="medium-3 columns">
        <div id="toc">
            <h3>Table of Contents</h3>
            <div class="tocList"><ul>
<li><a class="reference internal" href="#">Globalization Guidelines: Encoding</a><ul>
<li><a class="reference internal" href="#the-utf-8-encoding">The UTF-8 Encoding</a><ul>
<li><a class="reference internal" href="#you-should-always-use-utf-8-for-encoding-settings-wherever-applicable">You should always use UTF-8 for encoding settings wherever applicable.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#utf-8-file-encoding">UTF-8 File Encoding</a><ul>
<li><a class="reference internal" href="#you-should-encode-all-text-files-in-utf-8">You should encode all text files in UTF-8.</a></li>
<li><a class="reference internal" href="#you-must-specify-the-utf-8-encoding-in-every-html-file-before-any-non-english-characters">You must specify the UTF-8 encoding in every HTML file before any non-English characters.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sending-and-receiving-requests">Sending and Receiving Requests</a><ul>
<li><a class="reference internal" href="#you-must-use-the-bom-header-for-utf-16-files">You must use the BOM header for UTF-16 files.</a></li>
<li><a class="reference internal" href="#you-must-use-utf-8-to-decode-xhr-request-parameters">You must use UTF-8 to decode XHR request parameters.</a></li>
<li><a class="reference internal" href="#you-must-use-utf-8-encoding-when-using-a-non-english-string-in-a-url">You must use UTF-8 encoding when using a non-English string in a URL.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sending-responses">Sending Responses</a><ul>
<li><a class="reference internal" href="#you-must-set-content-type-in-an-http-response-header-if-the-response-is-not-encoded-in-utf-8">You must set Content-Type in an HTTP response header if the response is not encoded in UTF-8.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
          </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>

  <div class="row">
    <div class="medium-12 columns feedback">
        <a href="https://docs.google.com/spreadsheet/viewform?hl=en_US&formkey=dFlDcHEyaHMwbEd4MFBObkNrX0E1MFE6MQ&entry_0=http%3A%2F%2Fdojotoolkit.org%2Freference-guide%2F1.10%2F">Error in the documentation? Can’t find what you are looking for? Let us know!</a>
    </div>
  </div>
  <div class="row full footer">
	<div class="content">
		<div class="medium-6 columns copyright">
			<span>&copy; <a href="http://dojofoundation.org">The Dojo Foundation</a>, All Rights Reserved. <a href="https://raw.githubusercontent.com/dojo/dojo/master/LICENSE" class="license">License Information</a></span>
		</div>
		<div class="medium-6 columns info">
			<span>Internet Application Management Provided By <a href="http://www.reliam.com/">Reliam, Inc.</a></span>
		</div>
	</div>
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-22088032-1', 'auto');
		ga('send', 'pageview');
	</script>
</div>
  
  </body>
</html>