/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["CodeGlass.beautify"]){dojo._hasResource["CodeGlass.beautify"]=true;dojo.provide("CodeGlass.beautify");dojo.mixin(CodeGlass,{js_beautify:function(_1,_2){var _3,_4,_5,_6,_7,_8,_9,_a,_b;var _c,_d,_e,_f,_10,_11,_12;var _13,_14,_15,_16,_17,_18;var _19;_2=_2||{};var _1a=_2.indent_size||4;var _1b=_2.indent_char||" ";var _1c=typeof _2.preserve_newlines==="undefined"?true:_2.preserve_newlines;var _1d=_2.indent_level||0;var _1e=_2.space_after_anon_function==="undefined"?false:_2.space_after_anon_function;function _1f(){while(_4.length&&(_4[_4.length-1]===" "||_4[_4.length-1]===_b)){_4.pop();}};function _20(_21){_21=typeof _21==="undefined"?true:_21;_18=false;_1f();if(!_4.length){return;}if(_4[_4.length-1]!=="\n"||!_21){_4.push("\n");}for(var i=0;i<_19;i+=1){_4.push(_b);}};function _22(){var _23=" ";if(_4.length){_23=_4[_4.length-1];}if(_23!==" "&&_23!=="\n"&&_23!==_b){_4.push(" ");}};function _24(){_4.push(_5);};function _25(){_19+=1;};function _26(){if(_19){_19-=1;}};function _27(){if(_4.length&&_4[_4.length-1]===_b){_4.pop();}};function _28(_29){_a.push(_9);_9=_29;};function _2a(){_15=_9==="DO_BLOCK";_9=_a.pop();};function _2b(_2c,arr){for(var i=0;i<arr.length;i+=1){if(arr[i]===_2c){return true;}}return false;};function _2d(){var _2e=0,_2f=0;for(var i=_4.length-1;i>=0;i--){switch(_4[i]){case ":":if(_2e===0){_2f++;}break;case "?":if(_2e===0){if(_2f===0){return true;}else{_2f--;}}break;case "{":if(_2e===0){return false;}_2e--;break;case "(":case "[":_2e--;break;case ")":case "]":case "}":_2e++;break;}}};function _30(){var _31=0;if(_f>=_3.length){return ["","TK_EOF"];}var c=_3.charAt(_f);_f+=1;while(_2b(c,_c)){if(_f>=_3.length){return ["","TK_EOF"];}if(c==="\n"){_31+=1;}c=_3.charAt(_f);_f+=1;}var _32=false;if(_1c){if(_31>1){for(var i=0;i<2;i+=1){_20(i===0);}}_32=(_31===1);}if(_2b(c,_d)){if(_f<_3.length){while(_2b(_3.charAt(_f),_d)){c+=_3.charAt(_f);_f+=1;if(_f===_3.length){break;}}}if(_f!==_3.length&&c.match(/^[0-9]+[Ee]$/)&&(_3.charAt(_f)==="-"||_3.charAt(_f)==="+")){var _33=_3.charAt(_f);_f+=1;var t=_30(_f);c+=_33+t[0];return [c,"TK_WORD"];}if(c==="in"){return [c,"TK_OPERATOR"];}if(_32&&_6!=="TK_OPERATOR"&&!_18){_20();}return [c,"TK_WORD"];}if(c==="("||c==="["){return [c,"TK_START_EXPR"];}if(c===")"||c==="]"){return [c,"TK_END_EXPR"];}if(c==="{"){return [c,"TK_START_BLOCK"];}if(c==="}"){return [c,"TK_END_BLOCK"];}if(c===";"){return [c,"TK_SEMICOLON"];}if(c==="/"){var _34="";if(_3.charAt(_f)==="*"){_f+=1;if(_f<_3.length){while(!(_3.charAt(_f)==="*"&&_3.charAt(_f+1)&&_3.charAt(_f+1)==="/")&&_f<_3.length){_34+=_3.charAt(_f);_f+=1;if(_f>=_3.length){break;}}}_f+=2;return ["/*"+_34+"*/","TK_BLOCK_COMMENT"];}if(_3.charAt(_f)==="/"){_34=c;while(_3.charAt(_f)!=="\r"&&_3.charAt(_f)!=="\n"){_34+=_3.charAt(_f);_f+=1;if(_f>=_3.length){break;}}_f+=1;if(_32){_20();}return [_34,"TK_COMMENT"];}}if(c==="'"||c==="\""||(c==="/"&&((_6==="TK_WORD"&&_7==="return")||(_6==="TK_START_EXPR"||_6==="TK_START_BLOCK"||_6==="TK_END_BLOCK"||_6==="TK_OPERATOR"||_6==="TK_EOF"||_6==="TK_SEMICOLON")))){var sep=c;var esc=false;var _35=c;if(_f<_3.length){if(sep==="/"){var _36=false;while(esc||_36||_3.charAt(_f)!==sep){_35+=_3.charAt(_f);if(!esc){esc=_3.charAt(_f)==="\\";if(_3.charAt(_f)==="["){_36=true;}else{if(_3.charAt(_f)==="]"){_36=false;}}}else{esc=false;}_f+=1;if(_f>=_3.length){return [_35,"TK_STRING"];}}}else{while(esc||_3.charAt(_f)!==sep){_35+=_3.charAt(_f);if(!esc){esc=_3.charAt(_f)==="\\";}else{esc=false;}_f+=1;if(_f>=_3.length){return [_35,"TK_STRING"];}}}}_f+=1;_35+=sep;if(sep==="/"){while(_f<_3.length&&_2b(_3.charAt(_f),_d)){_35+=_3.charAt(_f);_f+=1;}}return [_35,"TK_STRING"];}if(c==="#"){var _37="#";if(_f<_3.length&&_2b(_3.charAt(_f),_12)){do{c=_3.charAt(_f);_37+=c;_f+=1;}while(_f<_3.length&&c!=="#"&&c!=="=");if(c==="#"){return [_37,"TK_WORD"];}else{return [_37,"TK_OPERATOR"];}}}if(c==="<"&&_3.substring(_f-1,_f+3)==="<!--"){_f+=3;return ["<!--","TK_COMMENT"];}if(c==="-"&&_3.substring(_f-1,_f+2)==="-->"){_f+=2;if(_32){_20();}return ["-->","TK_COMMENT"];}if(_2b(c,_e)){while(_f<_3.length&&_2b(c+_3.charAt(_f),_e)){c+=_3.charAt(_f);_f+=1;if(_f>=_3.length){break;}}return [c,"TK_OPERATOR"];}return [c,"TK_UNKNOWN"];};_b="";while(_1a>0){_b+=_1b;_1a-=1;}_19=_1d;_3=_1;_8="";_6="TK_START_EXPR";_7="";_4=[];_15=false;_16=false;_17=false;_c="\n\r\t ".split("");_d="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split("");_12="0123456789".split("");_e="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::".split(" ");_10="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(",");_9="BLOCK";_a=[_9];_f=0;_11=false;while(true){var t=_30(_f);_5=t[0];_14=t[1];if(_14==="TK_EOF"){break;}switch(_14){case "TK_START_EXPR":_16=false;if(_5==="["){if(_9==="[EXPRESSION]"){_20();_4.push(_b);}}if(_5==="["){_28("[EXPRESSION]");}else{_28("(EXPRESSION)");}if(_7===";"||_6==="TK_START_BLOCK"){_20();}else{if(_6==="TK_END_EXPR"||_6==="TK_START_EXPR"){}else{if(_6!=="TK_WORD"&&_6!=="TK_OPERATOR"){_22();}else{if(_8==="function"){if(_1e){_22();}}else{if(_2b(_8,_10)){_22();}}}}}_24();break;case "TK_END_EXPR":_2a();_24();break;case "TK_START_BLOCK":if(_8==="do"){_28("DO_BLOCK");}else{_28("BLOCK");}if(_6!=="TK_OPERATOR"&&_6!=="TK_START_EXPR"){if(_6==="TK_START_BLOCK"){_20();}else{_22();}}_24();_25();break;case "TK_END_BLOCK":if(_6==="TK_START_BLOCK"){_1f();_26();}else{_26();_20();}_24();_2a();break;case "TK_WORD":if(_15){_22();_24();_22();_15=false;break;}if(_5==="case"||_5==="default"){if(_7===":"){_27();}else{_26();_20();_25();}_24();_11=true;break;}_13="NONE";if(_6==="TK_END_BLOCK"){if(!_2b(_5.toLowerCase(),["else","catch","finally"])){_13="NEWLINE";}else{_13="SPACE";_22();}}else{if(_6==="TK_SEMICOLON"&&(_9==="BLOCK"||_9==="DO_BLOCK")){_13="NEWLINE";}else{if(_6==="TK_SEMICOLON"&&(_9==="[EXPRESSION]"||_9==="(EXPRESSION)")){_13="SPACE";}else{if(_6==="TK_STRING"){_13="NEWLINE";}else{if(_6==="TK_WORD"){_13="SPACE";}else{if(_6==="TK_START_BLOCK"){_13="NEWLINE";}else{if(_6==="TK_END_EXPR"){_22();_13="NEWLINE";}}}}}}}if(_6!=="TK_END_BLOCK"&&_2b(_5.toLowerCase(),["else","catch","finally"])){_20();}else{if(_2b(_5,_10)||_13==="NEWLINE"){if(_7==="else"){_22();}else{if((_6==="TK_START_EXPR"||_7==="="||_7===",")&&_5==="function"){}else{if(_7==="return"||_7==="throw"){_22();}else{if(_6!=="TK_END_EXPR"){if((_6!=="TK_START_EXPR"||_5!=="var")&&_7!==":"){if(_5==="if"&&_8==="else"){_22();}else{_20();}}}else{if(_2b(_5,_10)&&_7!==")"){_20();}}}}}}else{if(_13==="SPACE"){_22();}}}_24();_8=_5;if(_5==="var"){_16=true;_17=false;}if(_5==="if"||_5==="else"){_18=true;}break;case "TK_SEMICOLON":_24();_16=false;break;case "TK_STRING":if(_6==="TK_START_BLOCK"||_6==="TK_END_BLOCK"||_6==="TK_SEMICOLON"){_20();}else{if(_6==="TK_WORD"){_22();}}_24();break;case "TK_OPERATOR":var _38=true;var _39=true;if(_16&&_5!==","){_17=true;if(_5===":"){_16=false;}}if(_16&&_5===","&&(_9==="[EXPRESSION]"||_9==="(EXPRESSION)")){_17=false;}if(_5===":"&&_11){_24();_20();_11=false;break;}if(_5==="::"){_24();break;}if(_5===","){if(_16){if(_17){_24();_20();_17=false;}else{_24();_22();}}else{if(_6==="TK_END_BLOCK"){_24();_20();}else{if(_9==="BLOCK"){_24();_20();}else{_24();_22();}}}break;}else{if(_5==="--"||_5==="++"){if(_7===";"){if(_9==="BLOCK"){_20();_38=true;_39=false;}else{_38=true;_39=false;}}else{if(_7==="{"){_20();}_38=false;_39=false;}}else{if((_5==="!"||_5==="+"||_5==="-")&&(_7==="return"||_7==="case")){_38=true;_39=false;}else{if((_5==="!"||_5==="+"||_5==="-")&&_6==="TK_START_EXPR"){_38=false;_39=false;}else{if(_6==="TK_OPERATOR"){_38=false;_39=false;}else{if(_6==="TK_END_EXPR"){_38=true;_39=true;}else{if(_5==="."){_38=false;_39=false;}else{if(_5===":"){if(_2d()){_38=true;}else{_38=false;}}}}}}}}}if(_38){_22();}_24();if(_39){_22();}break;case "TK_BLOCK_COMMENT":_20();_24();_20();break;case "TK_COMMENT":_22();_24();_20();break;case "TK_UNKNOWN":_24();break;}_6=_14;_7=_5;}return _4.join("").replace(/\n+$/,"");}});}